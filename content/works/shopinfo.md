---
title: 情報サイトテンプレート
tags: ["技術", "地域"]
id: shopinfo
image: /works/shopinfo.png
description: 店舗向けの情報サイトのテンプレート
url: /works/shopinfo/
date: 2020-10-24 00:00:01
---

***

<img src="/works/shopinfo.png" width="100%">

***

<br>

## 3行で言うと

***

<br>

- 店舗を想定した情報サイトを作った
- **Nuxt.js** を **Amplify** と組み合わせて初めて活用してみた
- データの出し入れにまだまだ課題が山積

<br>

## 制作経緯

***

<br>

### コロナ対策の飲食店応援がきっかけで

- **新型コロナウイルス感染症** の影響で苦しむ飲食店のためにサイトを作ったが諸々の事情で終了
- リアルタイムなデータ更新まで持ってきたかったが及ばず、発想だけは生かして飲食に限らず他の業界にも応用できないかと着想
- 実際のリリースは未定だがひとまず雛形として作ってみた

<br>

## 構成

***

<br>

<img src="/works/shopinfo_architecture.png" width="100%">

### 詳細解説

- フロントエンドは **Amplify console** から **CloudFront** と **S3** を構成、 ユーザー側と管理者側でそれぞれ **Vue CLI** , **Nuxt.js** で作成したアプリケーション（PWA）をデプロイ
- 管理者側は **Amplify Auth** で **Cognito** ユーザープールを作成し、認証機能を実装
- ログインした管理者しかCRUD操作できないAPIを **AppSync** と **DynamoDB** で作成
- ユーザー側は権限を与えた **Lambda** 関数経由でReadのみ可能なAPIにリクエストを送信し、データ閲覧

<br>

### 使用技術

- **Vue.js**
  - **Vuetify** をインストール、UIコンポーネントが充実していてデザイン面は非常に捗った
  - 今回は **Vue CLI** を使ってプロジェクトを作ったが、初期設定で簡単に **PWA** にしたり、色々とプラグインもインストールできるので非常に便利
- **Nuxt.js**
  - フォルダ階層だけで自動生成されるルーティングが凄まじい
  - **SSR** , **SSG** , **SPA** に対応しており、今回は **SSG** を選択
  - **CLI** によるプロジェクト作成フローが優れており、 **TypeScript** や **PWA** 、主要なプラグイン類の導入が非常に容易
- **Amplify**
  - フロントエンドアプリケーションを非常に簡単にデプロイできる
  - **CI/CD** パイプラインが自動で構築され、 **Previews** を使用すればプレビュー用サイトもプルリクエストベースで作成できる
  - それだけだったら **Netlify** と大差ないが、その他の **AWS** 各種サービスと非常に容易に連携でき、バックエンドも構築できる
- **Cognito**
  - 割と煩雑なユーザー登録/認証機能を **Amplify** と組み合わせて爆速で作れる
  - 今回の場合、認証絡みのバックエンドのコードは一切必要としなかった
- **AppSync**
  - **GraphQL** インターフェースのAPIを簡単な設定でデプロイできる
  - **WebSocket** を応用したクライアント側へのリアルタイムなデータ反映も対応
- **Lambda**
  - **API Gateway** と接続すれば、プログラムコードを記述するだけで簡単にAPIを作成できる
  - **AWS** 上の各種リソースをプログラムから簡単に操作でき、今回はオープンなAPIにしているが、 **Amplify Auth** で追加した **Cognito** ユーザープールをオーソライザとして設定し、認証済みユーザーのみアクセス可能なAPIも簡単に作成できる
  - **Lambda** を使ってデータソースを無理やり取りにいくような実装になっており、イマイチ

<br>

## まとめ

***

<br>

- **DynamoDB** の **AppSync** と組み合わせた使い方をもっとちゃんとしたい（Publicアクセス周りとかもよく分からない部分が多い）
- **Lambda** で無理やりデータとってくるのはやっぱりかっこ悪い
- もう少し **Amplify** が成熟してきたら非常に使いやすく強力なツールになりそう